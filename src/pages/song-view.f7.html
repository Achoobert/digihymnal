<template>
  <div class="page">
    <div class="navbar">
      <div class="navbar-bg"></div>
      <div class="navbar-inner sliding">
        <div class="left">
          <a href="#" class="link back">
            <i class="icon icon-back"></i>
            <span class="if-not-md">Back</span>
          </a>
        </div>
        <div class="title">{{#if loading}}Song Title{{else}} {{song.title[lyric1]}} {{/if}}</div>
      </div>
    </div>
    <div class="page-content">
      {{#if loading}}
      {{else}}
      <div class="block-title">
        {{song.author[lyric1]}}
      </div>
      <div class="block">
        <strong>Key:</strong> {{song.key}}
      </div>
      <div class="menu">
        <div class="menu-inner">
          <a @click="zoomIn" class="menu-item icon-only">
            <div class="menu-item-content">
              <i class="fa-bigger fas fa-search-plus"></i>
            </div>
          </a>
          <a @click="zoomOut" class="menu-item icon-only">
            <div class="menu-item-content">
              <i class="fa-bigger fas fa-search-minus"></i>
            </div>
          </a>
          <div style="margin-left: auto" class="menu-item menu-item-dropdown">
            <div class="menu-item-content icon-only">
              <div class="menu-item-content">
                <i class="fa-bigger fas fa-language"></i>
              </div>
            </div>
            <div class="menu-dropdown menu-dropdown-right">
              <div class="menu-dropdown-content">
                <a href="#" class="menu-dropdown-link menu-close">
                  <span>Language #1</span>
                  <i class="margin-left fas fa-check-circle"></i>
                </a>
                <a href="#" class="menu-dropdown-link menu-close">
                  <span>Language #2</span>
                </a>
                <a href="#" class="menu-dropdown-link menu-close">
                  <span>Language #3</span>
                </a>
                <a href="#" class="menu-dropdown-link menu-close">
                  <span>Language #4</span>
                </a>
              </div>
            </div>
          </div>
          <div class="menu-item menu-item-dropdown">
            <div class="menu-item-content icon-only">
              <div class="menu-item-content">
                <i class="fa-bigger fas fa-music"></i>
              </div>
            </div>
            <div class="menu-dropdown menu-dropdown-right">
              <div class="menu-dropdown-content">
                <a href="#" class="menu-dropdown-link menu-close">
                  <span>Chords</span>
                </a>
                <a href="#" class="menu-dropdown-link menu-close">
                  <span>Asian</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="block block-strong" style="margin-top: 10px;">

        <div class="sheet">
          <div class="song">
          {{#each song.lyrics.Verse}}
            <h4>{{label}}</h4>
            {{#each lines}}
            <div class="line">
              {{#each phrases}}
              <div class="phrase">
                {{#if chord}}
                <div class="chord">{{chord}}</div>
                {{/if}}
                <div class="number">{{number}}</div>
                <div class="lyric">{{this[lyric1]}}</div>
                <div class="lyric">{{this[lyric2]}}</div>
              </div>
              {{/each}}
            </div>
            {{/each}}
          {{/each}}
          {{#each song.lyrics.Chorus}}
            <h4>{{label}}</h4>
            {{#each lines}}
            <div class="line">
              {{#each phrases}}
              <div class="phrase">
                {{#if chord}}
                <div class="chord">{{chord}}</div>
                {{/if}}
                <div class="number">{{number}}</div>
                <div class="lyric">{{at}}</div>
                <div class="lyric">{{ctr}}</div>
              </div>
              {{/each}}
            </div>
            {{/each}}
          {{/each}}
          {{#each song.lyrics.Bridge}}
            <h4>{{label}}</h4>
            {{#each lines}}
            <div class="line">
              {{#each phrases}}
              <div class="phrase">
                {{#if chord}}
                <div class="chord">{{chord}}</div>
                {{/if}}
                <div class="number">{{number}}</div>
                <div class="lyric">{{at}}</div>
                <div class="lyric">{{ctr}}</div>
              </div>
              {{/each}}
            </div>
            {{/each}}
          {{/each}}
          </div>
        </div>
      </div>
      {{/if}}
    </div>
  </div>
</template>
<style>
  .fa-bigger {
    font-size: larger;
  }
  .song {
    transform-origin: left top;
  }
  .line {
    margin-top: 30px;
  }
  .phrase {
    position: relative;
    display: inline-block;
  }
  .chord {
    bottom: 20px;
    background: var(--f7-theme-color);
    border-radius: 3px;
    min-width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    color: white;
    font-weight: bold;
  }
</style>
<script>
  import Song from '../data/song';
  const songCollection = new Song();
  songCollection.initSample();

  var initScale = 1;
  var lyric1 = "ct";
  var lyric2 = "ctr";
  export default {
    // Component Data
    data: function () {
      // Must return an object
      return {
        loading: true
      }
    },
    // Page Events
    on: {
      pageInit: function(e, page) {
        var self = this;
        var songId = this.$route.params.songId;
        songCollection.get(songId).then(result => {
          self.$setState({ loading: false, song: result });
        });
      },
    },
    methods: {
      zoomIn: function(e) {
        initScale += 0.05;
        this.$(".song")[0].style.transform = "scale("+initScale+")";
        this.$(".sheet")[0].style.height = (this.$(".song")[0].offsetHeight * initScale) + "px";
        // debugger;
      },
      zoomOut: function(e) {
        initScale -= 0.05;
        this.$(".song")[0].style.transform = "scale("+initScale+")";
        this.$(".sheet")[0].style.height = (this.$(".song")[0].offsetHeight * initScale) + "px";
        // debugger;
      }
    }
  }
</script>
